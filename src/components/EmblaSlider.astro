---
interface Props {
  title?: string;
}

const { title } = Astro.props;
const sliderId = `embla-${Math.random().toString(36).substr(2, 9)}`;
---

<div class="embla-slider" data-embla-id={sliderId}>
  {title && <h3 class="text-xl font-semibold mb-4 text-white">{title}</h3>}
  <div class="embla">
    <div class="embla__viewport">
      <div class="embla__container">
        <slot />
      </div>
    </div>
  </div>
</div>

<style>
  .embla-slider {
    width: 100%;
  }

  .embla {
    overflow: hidden;
  }

  .embla__viewport {
    overflow: hidden;
    width: 100%;
  }

  .embla__container {
    display: flex;
    gap: 0.75rem;
    touch-action: pan-y pinch-zoom;
  }

  @media (min-width: 768px) {
    .embla__container {
      gap: 1rem;
    }
  }

  .embla__container > :global(*) {
    flex: 0 0 auto;
    min-width: 0;
  }
</style>

<script>
  import EmblaCarousel from 'embla-carousel';

  document.addEventListener('DOMContentLoaded', () => {
    const emblaNodes = document.querySelectorAll('.embla-slider[data-embla-id]');

    emblaNodes.forEach(emblaNode => {
      const viewport = emblaNode.querySelector('.embla__viewport') as HTMLElement;
      if (!viewport) return;

      EmblaCarousel(viewport, {
        align: 'start',
        dragFree: true,
        containScroll: 'trimSnaps',
        direction: 'rtl'
      });
    });
  });
</script>
